<UserControl x:Class="StudentClinicMIS.Views.Registrar.AvailableDoctorsPanel"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             mc:Ignorable="d"
             d:DesignHeight="500" d:DesignWidth="800">

	<Grid Margin="16">
		<Grid.RowDefinitions>
			<RowDefinition Height="Auto"/>
			<RowDefinition Height="Auto"/>
			<RowDefinition Height="Auto"/>
			<RowDefinition Height="*"/>
			<RowDefinition Height="Auto"/>
		</Grid.RowDefinitions>

		<!-- Информация о выбранном пациенте -->
		<TextBlock x:Name="PatientTextBlock"
                   Grid.Row="0"
                   FontSize="16"
                   FontWeight="Bold"
                   Foreground="DarkSlateBlue"
                   Text="Пациент не выбран"
                   Margin="0,0,0,16"/>

		<!-- Панель выбора отделения -->
		<StackPanel Grid.Row="1" Orientation="Horizontal" Margin="0,0,0,12">
			<ComboBox x:Name="DepartmentComboBox"
                      Width="250"
                      DisplayMemberPath="Name"
                      SelectedValuePath="DepartmentId"
                      Style="{StaticResource MaterialDesignFilledComboBox}"
                      materialDesign:HintAssist.Hint="Отделение"
                      SelectionChanged="DepartmentComboBox_SelectionChanged"
                      Margin="0,0,12,0"/>

			<ComboBox x:Name="DoctorComboBox"
                      Width="250"
                      DisplayMemberPath="FullName"
                      SelectedValuePath="DoctorId"
                      Style="{StaticResource MaterialDesignFilledComboBox}"
                      materialDesign:HintAssist.Hint="Врач"
                      SelectionChanged="DoctorComboBox_SelectionChanged"
                      Margin="0,0,12,0"/>

			<DatePicker x:Name="AppointmentDatePicker"
                        Width="200"
                        Style="{StaticResource MaterialDesignDatePicker}"
                        materialDesign:HintAssist.Hint="Дата"
                        SelectedDateChanged="AppointmentDatePicker_SelectedDateChanged"/>
		</StackPanel>

		<!-- Список слотов -->
		<ListBox x:Name="SlotsListBox"
                 Grid.Row="2"
                 SelectionMode="Single"
                 Style="{StaticResource MaterialDesignListBox}"
                 Margin="0,0,0,12"
                 Height="80" />

		<!-- Таблица доступных врачей и слотов -->
		<DataGrid x:Name="DoctorsDataGrid"
                  Grid.Row="3"
                  AutoGenerateColumns="False"
                  CanUserAddRows="False"
                  IsReadOnly="True"
                  SelectionMode="Single"
                  RowHeight="60"
                  materialDesign:DataGridAssist.CellPadding="8"
                  Style="{StaticResource MaterialDesignDataGrid}"
                  ColumnHeaderStyle="{StaticResource MaterialDesignDataGridColumnHeader}">

			<DataGrid.Columns>
				<DataGridTextColumn Header="Врач" Binding="{Binding FullName}" Width="2*" />
				<DataGridTextColumn Header="Специальность" Binding="{Binding Specialization}" Width="2*" />

				<DataGridTemplateColumn Header="Свободные слоты" Width="3*">
					<DataGridTemplateColumn.CellTemplate>
						<DataTemplate>
							<ItemsControl ItemsSource="{Binding FreeSlots}">
								<ItemsControl.ItemsPanel>
									<ItemsPanelTemplate>
										<StackPanel Orientation="Horizontal"/>
									</ItemsPanelTemplate>
								</ItemsControl.ItemsPanel>
								<ItemsControl.ItemTemplate>
									<DataTemplate>
										<Button Content="{Binding}"
                                                Margin="2"
                                                Padding="6,2"
                                                MinWidth="50"
                                                Style="{StaticResource MaterialDesignOutlinedButton}"
                                                Click="SlotButton_Click"/>
									</DataTemplate>
								</ItemsControl.ItemTemplate>
							</ItemsControl>
						</DataTemplate>
					</DataGridTemplateColumn.CellTemplate>
				</DataGridTemplateColumn>
			</DataGrid.Columns>
		</DataGrid>

		<!-- Кнопка сохранения -->
		<Button Grid.Row="4"
                Content="Сохранить запись"
                HorizontalAlignment="Right"
                Margin="0,12,0,0"
                Style="{StaticResource MaterialDesignRaisedButton}"
                Click="SaveButton_Click"/>
	</Grid>
</UserControl>