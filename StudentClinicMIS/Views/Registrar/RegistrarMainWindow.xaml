<Window x:Class="StudentClinicMIS.Views.Registrar.RegistrarMainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
        xmlns:local="clr-namespace:StudentClinicMIS.Views.Registrar"
        
        Title="Регистратор"
        Height="750" 
        Width="1200"
        WindowStartupLocation="CenterScreen"
        Background="{DynamicResource MaterialDesignPaper}">

    <Grid Margin="16">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Панель навигации с иконками -->
        <TabControl Grid.Row="0" 
                    Style="{DynamicResource MaterialDesignNavigationTabControl}"
                    materialDesign:ColorZoneAssist.Mode="PrimaryMid">
            <TabItem IsSelected="True">
                <TabItem.Header>
                    <StackPanel Orientation="Horizontal">
                        <materialDesign:PackIcon Kind="AccountMultiple" Margin="0,0,8,0"/>
                        <TextBlock Text="Пациенты"/>
                    </StackPanel>
                </TabItem.Header>
            </TabItem>
            <TabItem>
                <TabItem.Header>
                    <StackPanel Orientation="Horizontal">
                        <materialDesign:PackIcon Kind="CalendarPlus" Margin="0,0,8,0"/>
                        <TextBlock Text="Запись на приём"/>
                    </StackPanel>
                </TabItem.Header>
            </TabItem>
            <TabItem>
                <TabItem.Header>
                    <StackPanel Orientation="Horizontal">
                        <materialDesign:PackIcon Kind="CalendarClock" Margin="0,0,8,0"/>
                        <TextBlock Text="Журнал посещений"/>
                    </StackPanel>
                </TabItem.Header>
            </TabItem>
            <TabItem>
                <TabItem.Header>
                    <StackPanel Orientation="Horizontal">
                        <materialDesign:PackIcon Kind="FileChart" Margin="0,0,8,0"/>
                        <TextBlock Text="Отчёты"/>
                    </StackPanel>
                </TabItem.Header>
            </TabItem>
        </TabControl>

        <!-- Основной контент -->
        <Grid Grid.Row="1" Margin="0,16,0,0">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <!-- Панель действий с иконками -->
            <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,16">
                <TextBox x:Name="SearchTextBox"
                         Width="300"
                         Margin="0,0,8,0"
                         materialDesign:HintAssist.Hint="Поиск пациента"
                         materialDesign:TextFieldAssist.HasClearButton="True"
                         Style="{DynamicResource MaterialDesignOutlinedTextBox}"
                         TextChanged="SearchTextBox_TextChanged"/>

                <Button Click="SearchButton_Click"
                        Margin="0,0,8,0"
                        Style="{DynamicResource MaterialDesignOutlinedButton}">
                    <StackPanel Orientation="Horizontal">
                        <materialDesign:PackIcon Kind="Magnify" Margin="0,0,4,0"/>
                        <TextBlock Text="Поиск"/>
                    </StackPanel>
                </Button>

                <Button Click="AddPatientButton_Click"
                        Margin="0,0,8,0"
                        Style="{DynamicResource MaterialDesignRaisedButton}">
                    <StackPanel Orientation="Horizontal">
                        <materialDesign:PackIcon Kind="Plus" Margin="0,0,4,0"/>
                        <TextBlock Text="Добавить"/>
                    </StackPanel>
                </Button>

                <Button Click="EditPatientButton_Click"
                        Margin="0,0,8,0"
                        Style="{DynamicResource MaterialDesignOutlinedButton}">
                    <StackPanel Orientation="Horizontal">
                        <materialDesign:PackIcon Kind="Pencil" Margin="0,0,4,0"/>
                        <TextBlock Text="Редактировать"/>
                    </StackPanel>
                </Button>

                <Button Click="DeletePatientButton_Click"
                        Margin="0,0,8,0"
                        Style="{DynamicResource MaterialDesignOutlinedButton}">
                    <StackPanel Orientation="Horizontal">
                        <materialDesign:PackIcon Kind="Delete" Margin="0,0,4,0"/>
                        <TextBlock Text="Удалить"/>
                    </StackPanel>
                </Button>

                <Button Click="ViewAppointmentsButton_Click"
                        Margin="0,0,8,0"
                        Style="{DynamicResource MaterialDesignOutlinedButton}">
                    <StackPanel Orientation="Horizontal">
                        <materialDesign:PackIcon Kind="History" Margin="0,0,4,0"/>
                        <TextBlock Text="История посещений"/>
                    </StackPanel>
                </Button>

                <Button Click="AddAppointmentButton_Click"
                        Style="{DynamicResource MaterialDesignRaisedButton}">
                    <StackPanel Orientation="Horizontal">
                        <materialDesign:PackIcon Kind="CalendarPlus" Margin="0,0,4,0"/>
                        <TextBlock Text="Записать на приём"/>
                    </StackPanel>
                </Button>
            </StackPanel>

            <!-- Таблица пациентов -->
            <DataGrid x:Name="PatientsDataGrid"
                      Grid.Row="1"
                      AutoGenerateColumns="False"
                      IsReadOnly="True"
                      SelectionMode="Single"
                      RowHeight="40"
                      SelectionUnit="FullRow"
                      CanUserAddRows="False"
                      CanUserDeleteRows="False"
                      CanUserReorderColumns="False"
                      CanUserResizeRows="False"
                      CanUserSortColumns="True"
                      MouseDoubleClick="PatientsDataGrid_MouseDoubleClick"
                      materialDesign:DataGridAssist.CellPadding="8,6"
                      Style="{DynamicResource MaterialDesignDataGrid}"
                      CellStyle="{DynamicResource MaterialDesignDataGridCell}"
                      ColumnHeaderStyle="{DynamicResource MaterialDesignDataGridColumnHeader}">
                <DataGrid.Columns>
                    <DataGridTextColumn Header="ФИО" Width="*" IsReadOnly="True">
                        <DataGridTextColumn.Binding>
                            <MultiBinding StringFormat="{}{0} {1} {2}">
                                <Binding Path="LastName"/>
                                <Binding Path="FirstName"/>
                                <Binding Path="MiddleName"/>
                            </MultiBinding>
                        </DataGridTextColumn.Binding>
                    </DataGridTextColumn>
                    <DataGridTextColumn Header="Дата рождения" 
                                      Binding="{Binding BirthDate, StringFormat=\{0:dd.MM.yyyy\}}" 
                                      Width="120"/>
                    <DataGridTextColumn Header="Пол" Binding="{Binding Gender}" Width="80"/>
                    <DataGridTextColumn Header="Телефон" Binding="{Binding Phone}" Width="150"/>
                    <DataGridTextColumn Header="Доп. телефон" Binding="{Binding AdditionalPhone}" Width="150"/>
                </DataGrid.Columns>
            </DataGrid>

            <!-- Статус бар -->
            <StatusBar Grid.Row="2" Background="{DynamicResource MaterialDesignToolBarBackground}">
                <StatusBarItem>
                    <TextBlock x:Name="StatusText" Text="Готово"/>
                </StatusBarItem>
                <StatusBarItem HorizontalAlignment="Right">
                    <TextBlock Text="{Binding ElementName=PatientsDataGrid, Path=Items.Count, StringFormat={}Всего пациентов: {0}}"/>
                </StatusBarItem>
            </StatusBar>
        </Grid>
    </Grid>
</Window>